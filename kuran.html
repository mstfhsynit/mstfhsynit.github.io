<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kuran Okuyucu</title>

<style>
body{
margin:0;
background:#111;
color:white;
font-family:Arial;
display:flex;
flex-direction:column;
align-items:center;
}

.top{
background:#1f1f1f;
padding:10px;
display:flex;
flex-wrap:wrap;
gap:6px;
justify-content:center;
width:100%;
}

button,select,input{
padding:7px;
border-radius:6px;
border:none;
}

.viewer{
position:relative;
width:95%;
max-width:750px;
margin:10px;
}

#page{
width:100%;
border-radius:12px;
}

.nav{
position:absolute;
top:50%;
transform:translateY(-50%);
font-size:28px;
background:rgba(0,0,0,.6);
color:white;
border:none;
padding:10px;
border-radius:50%;
cursor:pointer;
}

#prev{left:0}
#next{right:0}

.meal{
max-width:750px;
padding:12px;
background:#222;
border-radius:10px;
display:none;
line-height:1.7;
}

.dark{
background:#f5f5f5;
color:black;
}
.dark .top{background:#ddd}
.dark .meal{background:#eee}

</style>
</head>
<body>

<div class="top">

<select id="surah"></select>

<input id="jump" type="number" placeholder="Sayfa">

<button onclick="go()">Git</button>

<button onclick="toggle()">ðŸ“– Sayfa / ðŸ“œ Meal</button>
<button onclick="zoomIn()">+</button>
<button onclick="zoomOut()">-</button>
<button onclick="darkMode()">ðŸŒ™</button>
<button onclick="play()">ðŸ”Š</button>

</div>

<div class="viewer" id="pageView">
<button class="nav" id="prev">â¬…</button>
<img id="page">
<button class="nav" id="next">âž¡</button>
</div>

<div class="meal" id="mealView"></div>

<div>Sayfa: <span id="num">1</span></div>

<script>
let page=1;
let zoom=1;
let showMeal=false;
let audio=null;
const max=604;

const img=document.getElementById("page");
const num=document.getElementById("num");
const meal=document.getElementById("mealView");
const pageView=document.getElementById("pageView");
const surahSel=document.getElementById("surah");

function load(){
img.src=`https://www.mp3quran.net/api/quran_pages/${page}.png`;
num.innerText=page;
loadMeal();
}

function loadMeal(){
fetch(`https://api.alquran.cloud/v1/page/${page}/tr.elmalili`)
.then(r=>r.json())
.then(d=>{
meal.innerHTML=d.data.ayahs.map(a=>`<p>${a.text}</p>`).join("");
});
}

document.getElementById("next").onclick=()=>page<max&&(page++,load());
document.getElementById("prev").onclick=()=>page>1&&(page--,load());

function toggle(){
showMeal=!showMeal;
pageView.style.display=showMeal?"none":"block";
meal.style.display=showMeal?"block":"none";
}

function zoomIn(){zoom+=.1;img.style.transform=`scale(${zoom})`}
function zoomOut(){zoom=Math.max(.6,zoom-.1);img.style.transform=`scale(${zoom})`}

function darkMode(){document.body.classList.toggle("dark")}

function go(){
let p=document.getElementById("jump").value;
if(p>=1&&p<=max){page=parseInt(p);load();}
}

fetch("https://api.alquran.cloud/v1/surah")
.then(r=>r.json())
.then(d=>{
d.data.forEach(s=>{
let o=document.createElement("option");
o.value=s.number;
o.text=`${s.number}. ${s.name}`;
surahSel.appendChild(o);
});
});

surahSel.onchange=()=>{
fetch(`https://api.alquran.cloud/v1/surah/${surahSel.value}`)
.then(r=>r.json())
.then(d=>{
page=d.data.ayahs[0].page;
load();
});
}

function play(){
if(audio)audio.pause();
audio=new Audio(`https://cdn.islamic.network/quran/audio/128/ar.alafasy/${page}.mp3`);
audio.play();
}

// swipe
let x=0;
img.addEventListener("touchstart",e=>x=e.touches[0].clientX);
img.addEventListener("touchend",e=>{
let y=e.changedTouches[0].clientX;
if(x-y>50) page<max&&(page++,load());
if(y-x>50) page>1&&(page--,load());
});

load();
</script>

</body>
</html>
