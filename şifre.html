<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Password Manager</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{
margin:0;font-family:system-ui,sans-serif;min-height:100vh;
background:radial-gradient(circle at top left,#2563eb,transparent 40%),
radial-gradient(circle at bottom right,#9333ea,transparent 40%),#020617;
display:flex;justify-content:center;align-items:center;color:#e5e7eb}
.card{
width:100%;max-width:620px;margin:16px;
background:rgba(2,6,23,.95);
backdrop-filter:blur(14px);
border-radius:18px;padding:22px}
h2,h3{margin-top:0}
p{font-size:14px;opacity:.8;line-height:1.4}
input,button{
width:100%;padding:11px;margin-top:10px;
border-radius:10px;border:none;font-size:15px}
input{
background:#020617;color:#e5e7eb;border:1px solid #1e293b}
button{background:#2563eb;color:white;cursor:pointer}
.secondary{background:#334155}
.danger{background:#dc2626}
.hidden{display:none}
hr{border:none;height:1px;background:#1e293b;margin:18px 0}
.info{
background:#020617;border:1px solid #1e293b;
border-radius:12px;padding:12px;margin-bottom:14px;
font-size:14px;color:#cbd5f5}
.item{
background:#020617;border:1px solid #1e293b;
border-radius:10px;margin-top:10px;overflow:hidden}
.header{padding:10px;cursor:pointer}
.content{max-height:0;overflow:hidden;transition:.3s;padding:0 10px}
.item.open .content{max-height:300px;padding-bottom:10px}
.actions{display:flex;gap:6px;margin-top:6px}
.actions button{flex:1;font-size:13px;padding:6px}
.time{font-size:12px;opacity:.6}
.bar{height:6px;border-radius:4px;background:#1e293b;overflow:hidden;margin-top:6px}
.bar span{display:block;height:100%;width:0;background:#22c55e;transition:.3s}
</style>
</head>

<body>

<div class="card" id="auth"></div>

<div class="card hidden" id="app">

<h3>ğŸ” Password Manager</h3>

<div class="info">
ğŸ“±ğŸ’» <b>Ã‡oklu cihaz kullanÄ±mÄ±</b><br>
Bu uygulama cihaz bazlÄ± Ã§alÄ±ÅŸÄ±r.<br>
BaÅŸka PC veya telefonda kullanmak iÃ§in
<b>Export</b> alÄ±p <b>Import</b> yapÄ±n.
</div>

<input id="label" placeholder="Åifreye bir ad ver (Ã¶r: Gmail)">
<input type="password" id="pw" placeholder="Yeni ÅŸifre" oninput="strength()">
<div class="bar"><span id="power"></span></div>

<button onclick="save()">ğŸ’¾ Kaydet</button>

<hr>

<button class="secondary" onclick="exportVault()">ğŸ“¤ Export</button>
<input type="file" id="importFile" hidden onchange="importVault(this)">
<button class="secondary" onclick="document.getElementById('importFile').click()">ğŸ“¥ Import</button>

<hr>

<input id="search" placeholder="Kaydedilen ÅŸifrelerde ara..." oninput="load()">
<div id="list"></div>

<hr>

<button class="secondary" onclick="logout()">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>

</div>

<script>
const auth=document.getElementById("auth");
const app=document.getElementById("app");
let cryptoKey=null;

/* ===== AUTH UI ===== */
function renderAuth(){
if(!localStorage.getItem("user")){
auth.innerHTML=`
<h2>ğŸ“ Hesap OluÅŸtur</h2>
<p>Bu uygulama gÃ¼venli ve offline Ã§alÄ±ÅŸÄ±r.</p>
<input id="u" placeholder="KullanÄ±cÄ± adÄ±">
<input type="password" id="p1" placeholder="Master password">
<input type="password" id="p2" placeholder="Master password tekrar">
<p>âš ï¸ Master password unutulursa ÅŸifreler kurtarÄ±lamaz.</p>
<button onclick="register()">Hesap OluÅŸtur</button>`;
}else{
auth.innerHTML=`
<h2>ğŸ” GiriÅŸ</h2>
<input id="u" placeholder="KullanÄ±cÄ± adÄ±">
<input type="password" id="p" placeholder="Master password">
<button onclick="login()">GiriÅŸ Yap</button>`;
}}
renderAuth();

/* ===== CRYPTO ===== */
async function deriveKey(p,s){
const base=await crypto.subtle.importKey(
"raw",new TextEncoder().encode(p),"PBKDF2",false,["deriveKey"]);
return crypto.subtle.deriveKey(
{name:"PBKDF2",salt:s,iterations:100000,hash:"SHA-256"},
base,{name:"AES-GCM",length:256},false,["encrypt","decrypt"]);
}
async function encrypt(t){
const iv=crypto.getRandomValues(new Uint8Array(12));
const enc=await crypto.subtle.encrypt(
{name:"AES-GCM",iv},cryptoKey,new TextEncoder().encode(t));
return{iv:[...iv],data:[...new Uint8Array(enc)]};
}
async function decrypt(o){
const dec=await crypto.subtle.decrypt(
{name:"AES-GCM",iv:new Uint8Array(o.iv)},
cryptoKey,new Uint8Array(o.data));
return new TextDecoder().decode(dec);
}

/* ===== AUTH LOGIC ===== */
async function register(){
if(p1.value!==p2.value)return alert("Åifreler uyuÅŸmuyor");
const salt=crypto.getRandomValues(new Uint8Array(16));
cryptoKey=await deriveKey(p1.value,salt);
localStorage.setItem("user",u.value);
localStorage.setItem("salt",JSON.stringify([...salt]));
open();
}
async function login(){
const salt=new Uint8Array(JSON.parse(localStorage.getItem("salt")));
cryptoKey=await deriveKey(p.value,salt);
try{await load();open()}catch{alert("Master password yanlÄ±ÅŸ")}
}
function open(){
auth.classList.add("hidden");
app.classList.remove("hidden");
load();
}
function logout(){
cryptoKey=null;
app.classList.add("hidden");
auth.classList.remove("hidden");
}

/* ===== VAULT ===== */
function now(){
const d=new Date(),p=n=>String(n).padStart(2,"0");
return`${d.getFullYear()}-${p(d.getMonth()+1)}-${p(d.getDate())} ${p(d.getHours())}:${p(d.getMinutes())}:${p(d.getSeconds())}`;
}
async function save(){
let v=JSON.parse(localStorage.getItem("vault")||"[]");
v.push({
label:label.value,
password:await encrypt(pw.value),
created:now(),
last:null
});
localStorage.setItem("vault",JSON.stringify(v));
label.value="";pw.value="";power.style.width="0";
load();
}
async function load(){
list.innerHTML="";
let v=JSON.parse(localStorage.getItem("vault")||"[]");
v.forEach((x,i)=>{
if(!x.label.toLowerCase().includes(search.value.toLowerCase()))return;
list.innerHTML+=`
<div class="item">
<div class="header" onclick="this.parentNode.classList.toggle('open')">
<b>${x.label}</b>
<div class="time">ğŸ“… ${x.created}</div>
<div class="time">ğŸ•’ ${x.last||"-"}</div>
</div>
<div class="content">
<input type="password" id="p${i}">
<div class="actions">
<button onclick="show(${i})">ğŸ‘ï¸</button>
<button class="danger" onclick="del(${i})">ğŸ—‘ï¸</button>
</div>
</div></div>`;
});
}
async function show(i){
let v=JSON.parse(localStorage.getItem("vault"));
let el=document.getElementById("p"+i);
el.value=await decrypt(v[i].password);
el.type="text";
v[i].last=now();
localStorage.setItem("vault",JSON.stringify(v));
setTimeout(()=>el.type="password",3000);
}
function del(i){
let v=JSON.parse(localStorage.getItem("vault"));
v.splice(i,1);
localStorage.setItem("vault",JSON.stringify(v));
load();
}

/* ===== EXPORT / IMPORT ===== */
function exportVault(){
const data={
user:localStorage.getItem("user"),
salt:localStorage.getItem("salt"),
vault:localStorage.getItem("vault")
};
const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="password-vault.json";
a.click();
}
async function importVault(input){
const file=input.files[0];
if(!file)return;
const text=await file.text();
try{
const data=JSON.parse(text);
localStorage.setItem("user",data.user);
localStorage.setItem("salt",data.salt);
localStorage.setItem("vault",data.vault);
alert("Import tamamlandÄ±. GiriÅŸ yapabilirsiniz.");
location.reload();
}catch{alert("GeÃ§ersiz dosya")}
}

/* ===== STRENGTH ===== */
function strength(){
let s=0;
if(pw.value.length>=8)s+=25;
if(/[A-Z]/.test(pw.value))s+=25;
if(/[0-9]/.test(pw.value))s+=25;
if(/[^A-Za-z0-9]/.test(pw.value))s+=25;
power.style.width=s+"%";
}
</script>

</body>
</html>
