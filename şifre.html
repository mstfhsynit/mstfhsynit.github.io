<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Password Manager</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{
margin:0;font-family:system-ui,sans-serif;min-height:100vh;
background:radial-gradient(circle at top left,#2563eb,transparent 40%),
radial-gradient(circle at bottom right,#9333ea,transparent 40%),#020617;
display:flex;justify-content:center;align-items:center;color:#e5e7eb}
.card{width:100%;max-width:620px;margin:16px;
background:rgba(2,6,23,.95);backdrop-filter:blur(14px);
border-radius:18px;padding:20px}
input,button,select{
width:100%;padding:10px;margin-top:8px;
border-radius:10px;border:none;font-size:15px}
input,select{background:#020617;color:#e5e7eb}
button{background:#2563eb;color:white;cursor:pointer}
.secondary{background:#334155}
.danger{background:#dc2626}
.hidden{display:none}
hr{border:none;height:1px;background:#1e293b;margin:16px 0}
.item{background:#020617;border:1px solid #1e293b;
border-radius:10px;margin-top:10px;overflow:hidden}
.header{padding:10px;cursor:pointer}
.content{max-height:0;overflow:hidden;transition:.3s;padding:0 10px}
.item.open .content{max-height:350px;padding-bottom:10px}
.actions{display:flex;gap:6px;margin-top:6px}
.actions button{flex:1;font-size:13px;padding:6px}
.time{font-size:12px;opacity:.6}
.bar{height:6px;border-radius:4px;background:#1e293b;overflow:hidden}
.bar span{display:block;height:100%;width:0;background:#22c55e;transition:.3s}
.top{display:flex;gap:8px;align-items:center}
.top select{width:auto}
</style>
</head>

<body>

<div class="card" id="auth"></div>

<div class="card hidden" id="app">
<div class="top">
<h3 style="flex:1">üîê Password Manager</h3>
<select id="langSel"></select>
<button class="secondary" onclick="logout()">üö™</button>
</div>

<input id="label" placeholder="≈ûifre adƒ±">
<input type="password" id="pw" placeholder="≈ûifre" oninput="strength()">
<div class="bar"><span id="power"></span></div>
<button onclick="save()">üíæ Kaydet</button>

<hr>

<button class="secondary" onclick="changeMaster()">üîë Master Password Deƒüi≈ütir</button>

<hr>

<input id="search" placeholder="Ara..." oninput="load()">
<hr>
<div id="list"></div>
</div>

<script>
/* ========== LANGUAGE ========== */
const LANGS={
tr:{l:"≈ûifre adƒ±",p:"≈ûifre",s:"Kaydet",a:"Ara..."},
en:{l:"Label",p:"Password",s:"Save",a:"Search..."},
ar:{l:"ÿßÿ≥ŸÖ",p:"ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",s:"ÿ≠ŸÅÿ∏",a:"ÿ®ÿ≠ÿ´..."},
de:{l:"Name",p:"Passwort",s:"Speichern",a:"Suchen..."},
fr:{l:"Nom",p:"Mot de passe",s:"Enregistrer",a:"Rechercher..."},
es:{l:"Nombre",p:"Contrase√±a",s:"Guardar",a:"Buscar..."},
ru:{l:"–ò–º—è",p:"–ü–∞—Ä–æ–ª—å",s:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",a:"–ü–æ–∏—Å–∫..."},
it:{l:"Nome",p:"Password",s:"Salva",a:"Cerca..."},
pt:{l:"Nome",p:"Senha",s:"Salvar",a:"Buscar..."},
nl:{l:"Naam",p:"Wachtwoord",s:"Opslaan",a:"Zoeken..."}
};
let lang=localStorage.getItem("lang")||"tr";
const langSel=document.getElementById("langSel");
Object.keys(LANGS).forEach(x=>{
let o=document.createElement("option");
o.value=x;o.text=x.toUpperCase();
if(x===lang)o.selected=true;
langSel.appendChild(o);
});
langSel.onchange=e=>{
lang=e.target.value;
localStorage.setItem("lang",lang);
applyLang();
};
function applyLang(){
label.placeholder=LANGS[lang].l;
pw.placeholder=LANGS[lang].p;
search.placeholder=LANGS[lang].a;
}
applyLang();

/* ========== CRYPTO ========== */
let cryptoKey=null;
async function deriveKey(p,s){
const base=await crypto.subtle.importKey("raw",new TextEncoder().encode(p),"PBKDF2",false,["deriveKey"]);
return crypto.subtle.deriveKey(
{name:"PBKDF2",salt:s,iterations:100000,hash:"SHA-256"},
base,{name:"AES-GCM",length:256},false,["encrypt","decrypt"]);
}
async function encrypt(t){
const iv=crypto.getRandomValues(new Uint8Array(12));
const enc=await crypto.subtle.encrypt({name:"AES-GCM",iv},cryptoKey,new TextEncoder().encode(t));
return{iv:[...iv],data:[...new Uint8Array(enc)]};
}
async function decrypt(o){
const dec=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(o.iv)},cryptoKey,new Uint8Array(o.data));
return new TextDecoder().decode(dec);
}

/* ========== AUTH ========== */
const auth=document.getElementById("auth");
const app=document.getElementById("app");
function renderAuth(){
if(!localStorage.getItem("user")){
auth.innerHTML=`
<h2>üìù Hesap Olu≈ütur</h2>
<input id="u">
<input type="password" id="p1">
<input type="password" id="p2">
<button onclick="register()">Olu≈ütur</button>`;
}else{
auth.innerHTML=`
<h2>üîê Giri≈ü</h2>
<input id="u">
<input type="password" id="p">
<button onclick="login()">Giri≈ü</button>`;
}}
async function register(){
if(p1.value!==p2.value)return alert("Hata");
const salt=crypto.getRandomValues(new Uint8Array(16));
cryptoKey=await deriveKey(p1.value,salt);
localStorage.setItem("user",u.value);
localStorage.setItem("salt",JSON.stringify([...salt]));
open();
}
async function login(){
const salt=new Uint8Array(JSON.parse(localStorage.getItem("salt")));
cryptoKey=await deriveKey(p.value,salt);
try{await load();open()}catch{alert("≈ûifre yanlƒ±≈ü")}
}
function open(){auth.classList.add("hidden");app.classList.remove("hidden");load()}
function logout(){cryptoKey=null;app.classList.add("hidden");auth.classList.remove("hidden")}

/* ========== VAULT ========== */
function now(){
const d=new Date(),p=n=>String(n).padStart(2,"0");
return`${d.getFullYear()}-${p(d.getMonth()+1)}-${p(d.getDate())} ${p(d.getHours())}:${p(d.getMinutes())}:${p(d.getSeconds())}`;
}
async function save(){
let v=JSON.parse(localStorage.getItem("vault")||"[]");
v.push({label:label.value,password:await encrypt(pw.value),
created:now(),updated:null,last:null});
localStorage.setItem("vault",JSON.stringify(v));
label.value="";pw.value="";power.style.width="0";load();
}
async function load(){
list.innerHTML="";
let v=JSON.parse(localStorage.getItem("vault")||"[]");
v.forEach((x,i)=>{
if(!x.label.toLowerCase().includes(search.value.toLowerCase()))return;
list.innerHTML+=`
<div class="item">
<div class="header" onclick="this.parentNode.classList.toggle('open')">
<b>${x.label}</b>
<div class="time">üìÖ ${x.created}</div>
<div class="time">‚úèÔ∏è ${x.updated||"-"}</div>
<div class="time">üïí ${x.last||"-"}</div>
</div>
<div class="content">
<input type="password" id="p${i}">
<div class="actions">
<button onclick="show(${i})">üëÅÔ∏è</button>
<button onclick="editPw(${i})">‚úèÔ∏è</button>
<button class="danger" onclick="del(${i})">üóëÔ∏è</button>
</div>
</div></div>`;
});
}
async function show(i){
let v=JSON.parse(localStorage.getItem("vault"));
let el=document.getElementById("p"+i);
el.value=await decrypt(v[i].password);
el.type="text";
v[i].last=now();
localStorage.setItem("vault",JSON.stringify(v));
setTimeout(()=>el.type="password",3000);
}
async function editPw(i){
let v=JSON.parse(localStorage.getItem("vault"));
const n=prompt("Yeni ≈üifre:");
if(!n)return;
v[i].password=await encrypt(n);
v[i].updated=now();
localStorage.setItem("vault",JSON.stringify(v));
load();
}
function del(i){
let v=JSON.parse(localStorage.getItem("vault"));
v.splice(i,1);
localStorage.setItem("vault",JSON.stringify(v));
load();
}

/* ========== MASTER CHANGE ========== */
async function changeMaster(){
const oldP=prompt("Eski master:");
const salt=new Uint8Array(JSON.parse(localStorage.getItem("salt")));
try{
const oldKey=await deriveKey(oldP,salt);
let v=JSON.parse(localStorage.getItem("vault")||"[]");
let plain=[];
for(let x of v){
const d=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(x.password.iv)},oldKey,new Uint8Array(x.password.data));
plain.push(new TextDecoder().decode(d));
}
const newP=prompt("Yeni master:");
const newSalt=crypto.getRandomValues(new Uint8Array(16));
cryptoKey=await deriveKey(newP,newSalt);
for(let i=0;i<v.length;i++)v[i].password=await encrypt(plain[i]);
localStorage.setItem("salt",JSON.stringify([...newSalt]));
localStorage.setItem("vault",JSON.stringify(v));
alert("Deƒüi≈ütirildi");
}catch{alert("Hatalƒ±")}
}

/* ========== STRENGTH ========== */
function strength(){
let s=0;
if(pw.value.length>=8)s+=25;
if(/[A-Z]/.test(pw.value))s+=25;
if(/[0-9]/.test(pw.value))s+=25;
if(/[^A-Za-z0-9]/.test(pw.value))s+=25;
power.style.width=s+"%";
}

renderAuth();
</script>
</body>
</html>
