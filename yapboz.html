<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>8 Parçalı Yapboz</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  background: #f0f0f0;
  padding: 20px;
}
h1 { margin-bottom: 10px; }
#file-input { margin-bottom: 20px; }

/* Üstte parçaların bulunduğu container */
#pieces-container {
  margin-bottom: 20px;
  min-height: 70px;
  white-space: nowrap;
  overflow-x: auto;
  padding: 5px;
  border: 1px solid #aaa;
  background: #fff;
}

.piece {
  width: 60px;
  height: 60px;
  display: inline-block;
  margin-right: 5px;
  border: 1px solid #333;
  cursor: grab;
  position: relative;
}

.piece img {
  width: 360px;
  height: 360px;
  object-fit: none;
  position: absolute;
  top: 0;
  left: 0;
}

#puzzle-area {
  width: 360px;
  height: 360px;
  margin: auto;
  position: relative;
  border: 2px solid #333;
  background-color: #fff;
}

#puzzle-area img {
  position: absolute;
  top:0;
  left:0;
  width:360px;
  height:360px;
  object-fit: cover;
  z-index:0;
}

/* Ortadaki boş alan */
#drop-slot {
  width: 360px;
  height: 360px;
  position: absolute;
  top:0;
  left:0;
  border: 2px dashed #555;
  z-index:1;
  display: flex;
  flex-wrap: wrap;
  align-content: flex-start;
  background-color: rgba(255,255,255,0.1);
  justify-content: flex-start;
}
.drop-slot-piece {
  width: 120px;
  height: 120px;
  position: relative;
}
</style>
</head>
<body>
<h1>8 Parçalı Yapboz</h1>
<input type="file" id="file-input" accept="image/*"><br>
<div id="pieces-container"></div>
<div id="puzzle-area">
  <img id="background" src="" alt="Alt Resim">
  <div id="drop-slot"></div>
</div>

<script>
const fileInput = document.getElementById('file-input');
const piecesContainer = document.getElementById('pieces-container');
const background = document.getElementById('background');
const dropSlot = document.getElementById('drop-slot');

let imgSrc = "";
let currentPiece = null;

// Fotoğraf seçildiğinde
fileInput.addEventListener('change', e=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(event){
    imgSrc = event.target.result;
    background.src = imgSrc;
    createPieces();
  }
  reader.readAsDataURL(file);
});

function createPieces(){
  piecesContainer.innerHTML = "";
  dropSlot.innerHTML = "";

  const size = 120; // orta alandaki blok boyutu
  // 3x3 grid, orta parça boş -> 8 parça
  const positions = [
    {row:0,col:0},{row:0,col:1},{row:0,col:2},
    {row:1,col:0},           {row:1,col:2},
    {row:2,col:0},{row:2,col:1},{row:2,col:2},
  ];

  positions.forEach((pos,index)=>{
    // Üstteki küçük parça
    let div = document.createElement('div');
    div.className = 'piece';
    div.dataset.row = pos.row;
    div.dataset.col = pos.col;

    let img = document.createElement('img');
    img.src = imgSrc;
    img.style.top = `-${pos.row*size}px`;
    img.style.left = `-${pos.col*size}px`;

    div.appendChild(img);
    piecesContainer.appendChild(div);

    div.draggable = true;

    div.addEventListener('dragstart', e=>{
      currentPiece = div;
    });
  });
}

// Drop alan
dropSlot.addEventListener('dragover', e=>{
  e.preventDefault();
});

dropSlot.addEventListener('drop', e=>{
  e.preventDefault();
  if(currentPiece){
    // Drop-slot içine taşı
    let newDiv = document.createElement('div');
    newDiv.className = 'drop-slot-piece';
    
    // Orta alana resim kopyasını ekle
    let img = document.createElement('img');
    img.src = imgSrc;
    img.style.width = "360px";
    img.style.height = "360px";
    img.style.objectFit = "none";
    img.style.top = `-${currentPiece.dataset.row*120}px`;
    img.style.left = `-${currentPiece.dataset.col*120}px`;
    img.style.position = "absolute";

    newDiv.appendChild(img);
    dropSlot.appendChild(newDiv);

    // Üstten kaldır
    currentPiece.remove();
    currentPiece = null;
  }
});
</script>
</body>
</html>
