<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Online TaÅŸ KaÄŸÄ±t Makas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#1d2671,#c33764);
  font-family:Arial;
  color:#fff;
}

.box{
  width:360px;
  background:rgba(0,0,0,.45);
  padding:20px;
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.5);
}

h2{text-align:center;margin-top:0}

input,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border:none;
  border-radius:8px;
  font-size:15px;
}

button{
  cursor:pointer;
  background:#fff;
  font-weight:bold;
}

#roomCode{
  margin-top:10px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
  color:#7CFC00;
}

.hidden{display:none}

.info{
  text-align:center;
  margin-top:10px;
  font-size:16px;
}

.footer{
  margin-top:12px;
  font-size:12px;
  text-align:center;
  opacity:.8;
}
</style>
</head>

<body>

<div class="box">

<!-- GÄ°RÄ°Åž -->
<div id="login">
  <h2>TaÅŸ â€¢ KaÄŸÄ±t â€¢ Makas</h2>

  <input id="playerName" placeholder="Ä°smin">

  <button onclick="createRoom()">Oda OluÅŸtur</button>

  <div id="roomCode"></div>

  <hr style="margin:15px 0;opacity:.3">

  <input id="roomInput" placeholder="Oda Kodu">
  <button onclick="joinRoom()">Odaya KatÄ±l</button>

  <div class="footer">
    Menfaati bitenin ihaneti baÅŸlar.
  </div>
</div>

<!-- OYUN -->
<div id="game" class="hidden">
  <h2>Oyun OdasÄ±</h2>
  <div id="players" class="info"></div>
</div>

</div>

<script>
// ðŸ”¥ Firebase
firebase.initializeApp({
  apiKey: "AIzaSyBUpSbXWiF7f7pCkDaqOxI5bIseIMdzvnQ",
  authDomain: "tkm-online-e9c2b.firebaseapp.com",
  databaseURL: "https://tkm-online-e9c2b-default-rtdb.firebaseio.com",
  projectId: "tkm-online-e9c2b"
});

const db = firebase.database();

let room = "";
let me = "";
let role = "";

// ðŸŸ¢ ODA OLUÅžTUR
function createRoom(){
  const name = playerName.value.trim();
  if(name===""){
    alert("Ä°smini yaz");
    return;
  }

  me = name;
  role = "p1";
  room = Math.random().toString(36).substring(2,7).toUpperCase();

  db.ref("rooms/"+room).set({
    players:{
      p1:{name:me}
    }
  });

  roomCode.innerText = "ODA KODU: " + room;

  // ðŸ‘‡ SADECE RAKÄ°P GELÄ°NCE OYUNA GEÃ‡
  db.ref("rooms/"+room+"/players/p2").on("value", snap=>{
    if(snap.exists()){
      startGame();
    }
  });
}

// ðŸ”µ ODAYA KATIL
function joinRoom(){
  const name = playerName.value.trim();
  const code = roomInput.value.trim().toUpperCase();

  if(name==="" || code===""){
    alert("Ä°sim ve oda kodu gerekli");
    return;
  }

  me = name;
  room = code;
  role = "p2";

  db.ref("rooms/"+room+"/players/p2").set({
    name:me
  }, err=>{
    if(err){
      alert("Odaya girilemedi");
    }else{
      startGame();
    }
  });
}

// ðŸŽ® OYUNA GEÃ‡
function startGame(){
  login.classList.add("hidden");
  game.classList.remove("hidden");

  db.ref("rooms/"+room).on("value", snap=>{
    const d = snap.val();
    if(!d) return;

    const p1 = d.players.p1?.name || "â€”";
    const p2 = d.players.p2?.name || "Bekleniyor";

    players.innerText = p1 + " vs " + p2;
  });
}
</script>

</body>
</html>
