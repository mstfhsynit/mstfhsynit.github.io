<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Online TaÅŸ KaÄŸÄ±t Makas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
:root{--bg1:#1d2671;--bg2:#c33764}
body{margin:0;height:100vh;background:linear-gradient(135deg,var(--bg1),var(--bg2));
display:flex;align-items:center;justify-content:center;font-family:Arial;color:#fff}
.card{width:360px;background:rgba(0,0,0,.4);padding:18px;border-radius:16px;text-align:center}
input,button{padding:8px;border-radius:8px;border:none;margin:4px}
.buttons button{width:90px;height:90px;font-size:40px;border-radius:50%}
.hide{display:none}
.small{font-size:12px;opacity:.8}
.footer{margin-top:10px;font-style:italic;font-size:12px}
</style>
</head>
<body>

<div class="card">
  <h3>ğŸ® Online TaÅŸ-KaÄŸÄ±t-Makas</h3>

  <div id="lobby">
    <input id="name" placeholder="AdÄ±n" />
    <div>
      <button onclick="createRoom()">Oda OluÅŸtur</button>
      <button onclick="joinRoom()">Odaya KatÄ±l</button>
    </div>
    <input id="roomInput" placeholder="Oda Kodu" />
    <div class="small">ArkadaÅŸÄ±nla aynÄ± kodu kullanÄ±n</div>
  </div>

  <div id="game" class="hide">
    <div>Oda: <b id="roomCode"></b></div>
    <div class="buttons">
      <button onclick="choose('tas')">âœŠ</button>
      <button onclick="choose('kagit')">âœ‹</button>
      <button onclick="choose('makas')">âœŒï¸</button>
    </div>
    <div id="status">SeÃ§imini yap</div>
    <div class="footer">Menfaati bitenin ihaneti baÅŸlar.</div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, set, onValue, update } from
"https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBUpSbXWiF7f7pCkDaqOxI5bIseIMdzvnQ",
  authDomain: "tkm-online-e9c2b.firebaseapp.com",
  databaseURL: "https://tkm-online-e9c2b-default-rtdb.firebaseio.com",
  projectId: "tkm-online-e9c2b",
  messagingSenderId: "967040600662",
  appId: "1:967040600662:web:2b01ff890db04936cc09f7"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let roomId="", me="", role="";

const lobby = document.getElementById("lobby");
const game = document.getElementById("game");
const status = document.getElementById("status");
const roomCodeEl = document.getElementById("roomCode");

function genCode(){
  return Math.random().toString(36).substring(2,8).toUpperCase();
}

window.createRoom = () => {
  me = document.getElementById("name").value.trim();
  if(!me) return alert("Ad gir");
  roomId = genCode();
  role = "p1";
  set(ref(db,"rooms/"+roomId),{
    p1: me, c1: "", p2: "", c2: ""
  });
  enterRoom();
};

window.joinRoom = () => {
  me = document.getElementById("name").value.trim();
  roomId = document.getElementById("roomInput").value.trim().toUpperCase();
  if(!me || !roomId) return alert("Ad ve oda kodu gir");
  role = "p2";
  update(ref(db,"rooms/"+roomId),{ p2: me });
  enterRoom();
};

function enterRoom(){
  lobby.classList.add("hide");
  game.classList.remove("hide");
  roomCodeEl.textContent = roomId;

  onValue(ref(db,"rooms/"+roomId),(snap)=>{
    const d = snap.val();
    if(!d) return;
    if(d.c1 && d.c2){
      const res = result(d.c1,d.c2);
      status.innerHTML = `SonuÃ§: <b>${res}</b>`;
    }else{
      status.textContent = "Rakip bekleniyor...";
    }
  });
}

window.choose = (c) => {
  if(!roomId) return;
  const key = role==="p1" ? "c1" : "c2";
  update(ref(db,"rooms/"+roomId),{ [key]: c });
  status.textContent = "SeÃ§tin, rakip bekleniyor...";
};

function result(a,b){
  if(a===b) return "Berabere";
  if(
    (a==="tas"&&b==="makas")||
    (a==="kagit"&&b==="tas")||
    (a==="makas"&&b==="kagit")
  ) return "KazandÄ±n!";
  return "Kaybettin!";
}
</script>
</body>
</html>
