<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Åifre KasasÄ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
margin:0;
font-family:system-ui,Arial;
background:#020617;
color:#e5e7eb;
display:flex;
justify-content:center;
align-items:center;
min-height:100vh
}
.card{
background:#020617;
border:1px solid #334155;
border-radius:14px;
padding:20px;
width:100%;
max-width:420px;
box-sizing:border-box
}
h2{margin-top:0}
input,button{
width:100%;
padding:12px;
margin-top:10px;
border-radius:10px;
border:none;
box-sizing:border-box
}
input{
background:#020617;
color:#fff;
border:1px solid #334155
}
button{
background:#2563eb;
color:#fff;
cursor:pointer
}
button.secondary{
background:#020617;
border:1px solid #334155
}
.list{
margin-top:15px
}
.item{
border:1px solid #334155;
border-radius:10px;
padding:10px;
margin-top:10px
}
.hidden{display:none}
small{color:#94a3b8}
.actions{
display:flex;
gap:10px;
margin-top:10px
}
.actions button{flex:1}
</style>
</head>

<body>

<div class="card" id="app"></div>

<script>
const app = document.getElementById("app");
let importData = null;

/* ---------- RENDER ---------- */
function render(){
if(!localStorage.getItem("user")){
renderRegister();
}else if(!sessionStorage.getItem("logged")){
renderLogin();
}else{
renderVault();
}}
render();

/* ---------- REGISTER ---------- */
function renderRegister(){
app.innerHTML=`
<h2>ğŸ” Hesap OluÅŸtur</h2>
<input id="rUser" placeholder="KullanÄ±cÄ± adÄ±">
<input id="rPass1" type="password" placeholder="Åifre">
<input id="rPass2" type="password" placeholder="Åifre tekrar">
<button onclick="register()">OluÅŸtur</button>
`;
}

function register(){
const u=document.getElementById("rUser").value;
const p1=document.getElementById("rPass1").value;
const p2=document.getElementById("rPass2").value;

if(!u||!p1||!p2) return alert("TÃ¼m alanlarÄ± doldurun");
if(p1!==p2) return alert("Åifreler uyuÅŸmuyor");

localStorage.setItem("user",u);
localStorage.setItem("pass",p1);
localStorage.setItem("vault","[]");

alert("Hesap oluÅŸturuldu");
render();
}

/* ---------- LOGIN ---------- */
function renderLogin(){
app.innerHTML=`
<h2>ğŸ”‘ GiriÅŸ Yap</h2>
<input id="lUser" placeholder="KullanÄ±cÄ± adÄ±">
<input id="lPass" type="password" placeholder="Åifre">
<button onclick="login()">GiriÅŸ</button>
`;
}

function login(){
const u=document.getElementById("lUser").value;
const p=document.getElementById("lPass").value;

if(
u===localStorage.getItem("user") &&
p===localStorage.getItem("pass")
){
sessionStorage.setItem("logged","1");
render();
}else{
alert("HatalÄ± giriÅŸ");
}
}

/* ---------- VAULT ---------- */
function renderVault(){
const vault=JSON.parse(localStorage.getItem("vault")||"[]");
app.innerHTML=`
<h2>ğŸ” Åifre KasasÄ±</h2>

<input id="search" placeholder="Ara..." oninput="renderVault()">

<input id="name" placeholder="Åifre adÄ±">
<input id="pass" placeholder="Åifre">
<button onclick="add()">Kaydet</button>

<div class="actions">
<button class="secondary" onclick="exportVault()">Export</button>
<button class="secondary" onclick="document.getElementById('file').click()">Import</button>
<button class="secondary" onclick="logout()">Ã‡Ä±kÄ±ÅŸ</button>
</div>

<input type="file" id="file" hidden onchange="prepareImport(this)">

<div class="list">
${vault.filter(v=>{
const q=document.getElementById("search")?.value||"";
return v.name.toLowerCase().includes(q.toLowerCase());
}).map((v,i)=>`
<div class="item">
<b>${v.name}</b><br>
<input type="password" value="${v.pass}" readonly id="p${i}">
<button onclick="toggle(${i})">ğŸ‘ï¸</button><br>
<small>OluÅŸturma: ${v.created}</small><br>
<small>Son kullanÄ±m: ${v.last||"-"}</small>
</div>
`).join("")}
</div>

<div id="importBox" class="hidden">
<h3>ğŸ” Import DoÄŸrulama</h3>
<input id="impUser" placeholder="KullanÄ±cÄ± adÄ±">
<input id="impPass" type="password" placeholder="Åifre">
<button onclick="confirmImport()">DoÄŸrula</button>
</div>
`;
}

/* ---------- VAULT ACTIONS ---------- */
function add(){
const name=document.getElementById("name").value;
const pass=document.getElementById("pass").value;
if(!name||!pass) return alert("BoÅŸ alan var");

const vault=JSON.parse(localStorage.getItem("vault"));
vault.push({
name,
pass,
created:new Date().toLocaleString(),
last:null
});
localStorage.setItem("vault",JSON.stringify(vault));
renderVault();
}

function toggle(i){
const el=document.getElementById("p"+i);
el.type=el.type==="password"?"text":"password";

const vault=JSON.parse(localStorage.getItem("vault"));
vault[i].last=new Date().toLocaleString();
localStorage.setItem("vault",JSON.stringify(vault));
renderVault();
}

function logout(){
sessionStorage.clear();
render();
}

/* ---------- EXPORT ---------- */
function exportVault(){
const data=JSON.stringify({
user:localStorage.getItem("user"),
pass:localStorage.getItem("pass"),
vault:localStorage.getItem("vault")
},null,2);

const blob=new Blob([data],{type:"text/plain"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="sifreler.txt";
a.click();
}

/* ---------- IMPORT ---------- */
function prepareImport(input){
if(!input.files[0]) return;
importData=null;
const reader=new FileReader();
reader.onload=()=>{
try{
importData=JSON.parse(reader.result);
document.getElementById("importBox").classList.remove("hidden");
}catch{
alert("GeÃ§ersiz dosya");
}
};
reader.readAsText(input.files[0]);
}

function confirmImport(){
if(!importData){
alert("Ã–nce dosya seÃ§in");
return;
}

const u=document.getElementById("impUser").value;
const p=document.getElementById("impPass").value;

if(u!==importData.user || p!==importData.pass)
return alert("Bilgiler yanlÄ±ÅŸ");

localStorage.setItem("user",importData.user);
localStorage.setItem("pass",importData.pass);
localStorage.setItem("vault",importData.vault);

alert("Import baÅŸarÄ±lÄ±");
location.reload();
}
</script>

</body>
</html>
